```{r helper_meta,  include = F}
# don't stratify by sex if exposure is HRT
if(params$exposure %in% c("hrt_ref_pm2", "eo_ref_pm_gxe", "ep_ref_pm_gxe", "pure_eo_allNo", "pure_ep_allNo")) {
  stratify_by_sex = F
} else {
  stratify_by_sex = T
}

# covariates - remove pc and study_gxe (keep sex in sex stratified for convenience in scripting)
covariates_forest <- sort(covariates[which(!covariates %in% c(paste0(rep('pc', 20), seq(1, 20)), "study_gxe"))])
```


### All
```{r  out.width="49%", echo = F, message = F, warning = F, cache = F}
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_all.png"))
knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_all.png"))
```

### Sex
```{r  out.width="49%", echo = F, message = F, warning = F, cache = F, eval=stratify_by_sex}
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest[which(!covariates_forest %in% c('sex'))], sep = '_')}_female.png"))
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest[which(!covariates_forest %in% c('sex'))], sep = '_')}_male.png"))
knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest[which(!covariates_forest %in% c('sex'))], sep = '_')}_female.png"))
knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest[which(!covariates_forest %in% c('sex'))], sep = '_')}_male.png"))
```


### Tumor site
```{r  out.width="49%", echo = F, message = F, warning = F, cache = F}
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_proximal.png"))
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_distal.png"))
knitr::include_graphics(glue("{path_posthoc}/forest_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_rectal.png"))

knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_proximal.png"))
knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_distal.png"))
knitr::include_graphics(glue("{path_posthoc}/funnel_plot_{params$exposure}_{params$hrc_version}_{glue_collapse(covariates_forest, sep = '_')}_rectal.png"))
```
